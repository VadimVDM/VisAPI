{"file":"/Users/vadim/Projects/VisAPI/apps/backend/src/health/indicators/redis.health.ts","mappings":";;;;;AAAA,2CAA4C;AAC5C,+CAI0B;AAC1B,mDAAkD;AAG3C,IAAM,oBAAoB,GAA1B,MAAM,oBAAqB,SAAQ,0BAAe;IACvD,YAA6B,YAA0B;QACrD,KAAK,EAAE,CAAC;QADmB,iBAAY,GAAZ,YAAY,CAAc;IAEvD,CAAC;IAEK,SAAS,CAAC,GAAW;;YACzB,IAAI,CAAC;gBACH,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,eAAe,EAAE,CAAC;gBAE5D,IAAI,SAAS,EAAE,CAAC;oBACd,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,EAAE;wBAC/B,OAAO,EAAE,oCAAoC;qBAC9C,CAAC,CAAC;gBACL,CAAC;gBAED,MAAM,IAAI,2BAAgB,CACxB,yBAAyB,EACzB,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,KAAK,EAAE;oBACzB,OAAO,EAAE,kCAAkC;iBAC5C,CAAC,CACH,CAAC;YACJ,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBACf,MAAM,IAAI,2BAAgB,CACxB,yBAAyB,EACzB,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,KAAK,EAAE;oBACzB,OAAO,EAAE,4BAA4B;oBACrC,KAAK,EAAE,KAAK,CAAC,OAAO;iBACrB,CAAC,CACH,CAAC;YACJ,CAAC;QACH,CAAC;KAAA;CACF,CAAA;AA/BY,oDAAoB;+BAApB,oBAAoB;IADhC,IAAA,mBAAU,GAAE;iEAEgC,yBAAY,oBAAZ,yBAAY;GAD5C,oBAAoB,CA+BhC","names":[],"sources":["/Users/vadim/Projects/VisAPI/apps/backend/src/health/indicators/redis.health.ts"],"sourcesContent":["import { Injectable } from '@nestjs/common';\nimport {\n  HealthIndicator,\n  HealthIndicatorResult,\n  HealthCheckError,\n} from '@nestjs/terminus';\nimport { RedisService } from '@visapi/util-redis';\n\n@Injectable()\nexport class RedisHealthIndicator extends HealthIndicator {\n  constructor(private readonly redisService: RedisService) {\n    super();\n  }\n\n  async isHealthy(key: string): Promise<HealthIndicatorResult> {\n    try {\n      const isHealthy = await this.redisService.checkConnection();\n\n      if (isHealthy) {\n        return this.getStatus(key, true, {\n          message: 'Redis is accessible and responsive',\n        });\n      }\n\n      throw new HealthCheckError(\n        'Redis connection failed',\n        this.getStatus(key, false, {\n          message: 'Redis ping exceeded timeout (1s)',\n        })\n      );\n    } catch (error) {\n      throw new HealthCheckError(\n        'Redis connection failed',\n        this.getStatus(key, false, {\n          message: 'Unable to connect to Redis',\n          error: error.message,\n        })\n      );\n    }\n  }\n}\n"],"version":3}