{"file":"/Users/vadim/Projects/VisAPI/apps/backend/src/test-setup.ts","mappings":";;;;AAiCA,oCAAoC;AACpC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,EAAE;IACxB,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,GAAG,EAAE,CAAC,CAAC;QACzC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,iBAAiB,CAAC,MAAM,CAAC;QACzC,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,iBAAiB,CAAC,SAAS,CAAC;QAClD,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE;KACd,CAAC,CAAC,CAAC;AACN,CAAC,CAAC,CAAC;AAxCH,6CAAuC;AACvC,2CAA8C;AAC9C,qDAAoD;AAEpD,uBAAuB;AACvB,OAAO,CAAC,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC;AAE9B,oCAAoC;AACpC,MAAM,kBAAkB,GAAG,OAAO,CAAC,GAAG,CAAC;AACvC,MAAM,oBAAoB,GAAG,OAAO,CAAC,KAAK,CAAC;AAE3C,SAAS,CAAC,GAAG,EAAE;IACb,yDAAyD;IACzD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;QAC7B,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QACxB,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;IAC5B,CAAC;IAED,4CAA4C;IAC5C,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AACzB,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,GAAS,EAAE;IAClB,kBAAkB;IAClB,OAAO,CAAC,GAAG,GAAG,kBAAkB,CAAC;IACjC,OAAO,CAAC,KAAK,GAAG,oBAAoB,CAAC;IAErC,wCAAwC;IACxC,IAAI,MAAM,CAAC,EAAE,EAAE,CAAC;QACd,MAAM,CAAC,EAAE,EAAE,CAAC;IACd,CAAC;AACH,CAAC,CAAA,CAAC,CAAC;AAWH,wCAAwC;AACjC,MAAM,gBAAgB,GAAG,CAC9B,YAAmB,EAAE,EACrB,UAAiB,EAAE,EACnB,EAAE;IACF,OAAO,cAAI,CAAC,mBAAmB,CAAC;QAC9B,OAAO,EAAE;YACP,qBAAY,CAAC,OAAO,CAAC;gBACnB,IAAI,EAAE,CAAC,2BAAa,CAAC;gBACrB,QAAQ,EAAE,IAAI;aACf,CAAC;YACF,GAAG,OAAO;SACX;QACD,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC;KAC1B,CAAC,CAAC;AACL,CAAC,CAAC;AAdW,QAAA,gBAAgB,oBAc3B","names":[],"sources":["/Users/vadim/Projects/VisAPI/apps/backend/src/test-setup.ts"],"sourcesContent":["import { Test } from '@nestjs/testing';\nimport { ConfigModule } from '@nestjs/config';\nimport { configuration } from '@visapi/core-config';\n\n// Set test environment\nprocess.env.NODE_ENV = 'test';\n\n// Reduce console noise during tests\nconst originalConsoleLog = console.log;\nconst originalConsoleError = console.error;\n\nbeforeAll(() => {\n  // Suppress console logs during tests unless DEBUG is set\n  if (!process.env.DEBUG_TESTS) {\n    console.log = jest.fn();\n    console.error = jest.fn();\n  }\n  \n  // Set shorter timeouts for test environment\n  jest.setTimeout(10000);\n});\n\nafterAll(async () => {\n  // Restore console\n  console.log = originalConsoleLog;\n  console.error = originalConsoleError;\n  \n  // Force garbage collection if available\n  if (global.gc) {\n    global.gc();\n  }\n});\n\n// Mock external services by default\njest.mock('ioredis', () => {\n  return jest.fn().mockImplementation(() => ({\n    ping: jest.fn().mockResolvedValue('PONG'),\n    disconnect: jest.fn().mockResolvedValue(undefined),\n    on: jest.fn(),\n  }));\n});\n\n// Helper function to create test module\nexport const createTestModule = (\n  providers: any[] = [],\n  imports: any[] = []\n) => {\n  return Test.createTestingModule({\n    imports: [\n      ConfigModule.forRoot({\n        load: [configuration],\n        isGlobal: true,\n      }),\n      ...imports,\n    ],\n    providers: [...providers],\n  });\n};\n"],"version":3}